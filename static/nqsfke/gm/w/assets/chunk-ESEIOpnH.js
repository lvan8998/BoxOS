import{d as a}from"./chunk-DWTGLlOg.js";import{r as t,A as e,i}from"./ht-DIEl3wcJ.js";import{r as n}from"./chunk-DPRUGDB1.js";const u=a("ChiGua",()=>{const a=n([]),u=n(1),r=n(1),l=n(!1),o=n(!1),s=n(""),c=n(),v=n(!1),d=n(!1),g=n([]),h=n(!1),f=n("");function m(){a.value=[]}return{isLoading:l,dataList:a,pageNo:u,totalPage:r,isShowComment:d,isShowBarrage:v,artDetailModel:c,artContentStrs:g,isSending:h,setPageNo:function(a){u.value=a},setArtId:function(a){s.value=a},clearDanMuInput:function(){f.value=""},danMuText:f,resetChiGuaList:m,reqChiGuaList:async function(){l.value=!0,r.value=1,m();let n=await t(e.getArts,{pageNo:u.value-1,pageSize:20});if(i(n.code)){a.value=n.data.artList;const t=n.data.totalPage;r.value=t<1?1:t}l.value=!1},isDetailLoading:o,resetChiGuaDetail:function(){f.value="",c.value=void 0,v.value=!1,d.value=!1},reqChiDetail:async function(){var a,n;o.value=!0;let u=await t(e.queryArtDetail,{artId:s.value});i(u.code)&&(c.value=u.data.artDetail,document.title=null!=(n=null==(a=c.value)?void 0:a.artName)?n:"",v.value=u.data.isShowBarrage,d.value=u.data.isShowComment,function(){const a=c.value.artContent,t=[];let e="",i=0;try{for(;i<a.length;)if(i<=a.length-4&&"<img"===a.substring(i,i+4)){e.trim()&&(t.push(e.trim().split("$$$").join("")),e="");let n=a.indexOf(">",i);if(-1===n&&(n=a.indexOf("<img",i),-1===n))break;const u=a.substring(i,n+1).match(/src\s*=\s*['"]([^'"]+)['"]/);u&&u[1]&&t.push(u[1]),i=n+1}else e+=a[i],i++;e.trim()&&t.push(e.trim().split("$$$").join("")),g.value=t}catch(n){}}()),o.value=!1},reqSendDanMu:async function(a,i){h.value=!0;let n=await t(e.addBarrage,{contentId:s.value,barrageMsg:a,currencyDuration:Math.floor(i/1e3)});return h.value=!1,n}}});export{u};
